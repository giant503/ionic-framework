<!DOCTYPE html>
<html dir="ltr">

<head>
  <meta charset="UTF-8">
  <title>Ionic Item Sliding</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <script src="/dist/ionic.js"></script>
</head>

<body>
  <ion-app>
    <ion-page>

      <ion-header>
        <ion-toolbar>
          <ion-title>Ionic CDN demo</ion-title>
        </ion-toolbar>
      </ion-header>

      <ion-content>
        <ion-virtual-scroll id="virtual"></ion-virtual-scroll>
      </ion-content>

    </ion-page>

  </ion-app>

  <script>


    async function init() {
      const virtual = await document.getElementById('virtual').componentOnReady();
      virtual.approxItemHeight = 200;
      // virtual.itemHeight = (item) => 69 + 40 + 22 * Math.ceil(item.content.length/30);
      virtual.headerFn = (item, index) => {
        if (index % 20 === 0) {
          return 'Header ' + index;
        }
        return null;
      }


      function renderItem(el, item) {
        if (!el) {
          el = document.createElement('ion-card');
        }
        el.innerHTML = `
        <ion-card-header>
          <ion-card-title>Card Header</ion-card-title>
        </ion-card-header>
        <ion-card-content>${item.content}</ion-card-content>`;
        return el;
      }

      function renderHeader(el, item) {
        if (!el) {
          el = document.createElement('ion-item-divider');
        }
        el.textContent = item;
        return el;
      }

      virtual.itemRender = (el, cell) => {
        if (cell.type === 0) return renderItem(el, cell.value);
        return renderHeader(el, cell.value);
      };


      function getImgSrc() {
        let src = images[rotateImg];
        rotateImg++;
        if (rotateImg === images.length) rotateImg = 0;
        return src;
      }

      let rotateImg = 0;

      const items = [];
      for (var i = 0; i < 1000; i++) {
        items.push({
          name: i + ' - ' + images[rotateImg],
          imgSrc: getImgSrc(),
          avatarSrc: getImgSrc(),
          imgHeight: Math.floor((Math.random() * 50) + 150),
          content: lorem.substring(0, (Math.random() * (lorem.length - 100)) + 100)
        });
        rotateImg++;
      }
      virtual.items = items;
    };
    setTimeout(init, 200);
  </script>

</body>
</html>
